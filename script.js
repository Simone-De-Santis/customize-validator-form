$(document).ready(function () {

	//£ oggetto per il confronto tra i dati inseriti
	const objLocalizationPath = {
		italia: {
			localization: "italia",
			prefixCellular: ["+39", "0039", "0039"],
			prefixCompanyCellular: [
				"330",
				"333",
				"334",
				"335",
				"336",
				"337",
				"338",
				"339",
				"360",
				"363",
				"366",
				"368",
				"352",
				"340",
				"342",
				"345",
				"346",
				"347",
				"348",
				"349",
				"320",
				"323",
				"327",
				"328",
				"329",
				"380",
				"383",
				"388",
				"389",
				"390",
				"391",
				"392",
				"393",
				"397",
				"331",
				"370",
				"353",
				"375",
				"379",
				"373",
				"350",
				"351",
				"382",
				"376",
				"371",
				"377",
				"378",
			],
			prefixHomePhone: [
				"004191",
				"010",
				"011",
				"012",
				"012",
				"012",
				"012",
				"012",
				"013",
				"014",
				"014",
				"014",
				"014",
				"015",
				"016",
				"016",
				"016",
				"016",
				"017",
				"017",
				"017",
				"017",
				"017",
				"018",
				"018",
				"018",
				"018",
				"018",
				"019",
				"02",
				"030",
				"031",
				"032",
				"032",
				"032",
				"032",
				"033",
				"033",
				"034",
				"034",
				"034",
				"034",
				"034",
				"034",
				"035",
				"036",
				"036",
				"036",
				"036",
				"037",
				"037",
				"037",
				"037",
				"037",
				"037",
				"037",
				"038",
				"038",
				"038",
				"038",
				"038",
				"038",
				"039",
				"040",
				"041",
				"042",
				"042",
				"042",
				"042",
				"042",
				"042",
				"042",
				"042",
				"042",
				"043",
				"043",
				"043",
				"043",
				"043",
				"043",
				"043",
				"043",
				"043",
				"044",
				"044",
				"044",
				"045",
				"046",
				"046",
				"046",
				"046",
				"046",
				"047",
				"047",
				"047",
				"047",
				"048",
				"049",
				"050",
				"051",
				"052",
				"052",
				"052",
				"052",
				"052",
				"053",
				"053",
				"053",
				"053",
				"053",
				"054",
				"054",
				"054",
				"054",
				"054",
				"054",
				"054",
				"055",
				"056",
				"056",
				"056",
				"057",
				"057",
				"057",
				"057",
				"057",
				"057",
				"057",
				"058",
				"058",
				"058",
				"058",
				"058",
				"058",
				"059",
				"06070",
				"071",
				"072",
				"072",
				"073",
				"073",
				"073",
				"073",
				"073",
				"073",
				"073",
				"074",
				"074",
				"074",
				"074",
				"075",
				"076",
				"076",
				"076",
				"076",
				"077",
				"077",
				"077",
				"077",
				"077",
				"078",
				"078",
				"078",
				"078",
				"078",
				"078",
				"079",
				"080",
				"081",
				"082",
				"082",
				"082",
				"082",
				"082",
				"083",
				"083",
				"083",
				"083",
				"083",
				"085",
				"086",
				"086",
				"086",
				"086",
				"086",
				"087",
				"087",
				"087",
				"087",
				"087",
				"088",
				"088",
				"088",
				"088",
				"088",
				"089",
				"090",
				"091",
				"092",
				"092",
				"092",
				"092",
				"092",
				"093",
				"093",
				"093",
				"093",
				"093",
				"094",
				"094",
				"095",
				"096",
				"096",
				"096",
				"096",
				"096",
				"096",
				"096",
				"096",
				"097",
				"097",
				"097",
				"097",
				"097",
				"097",
				"098",
				"098",
				"098",
				"098",
				"098",
				"099",
			],
		},
		spagna: {
			localization: "spagna",
			prefixCellular: ["+38", "0038"],
			prefixCompanyCellular: [
				"330",
				"333",
				"334",
				"335",
				"336",
				"337",
				"338",
				"339",
				"360",
				"363",
				"366",
				"368",
				"352",
				"340",
				"342",
				"345",
				"346",
				"347",
				"348",
				"349",
				"320",
				"323",
				"327",
				"328",
				"329",
				"380",
				"383",
				"388",
				"389",
				"390",
				"391",
				"392",
				"393",
				"397",
				"331",
				"370",
				"353",
				"375",
				"379",
				"373",
				"350",
				"351",
				"382",
				"376",
				"371",
				"377",
				"378",
			],
			prefixHomePhone: [
				"004191",
				"010",
				"011",
				"012",
				"012",
				"012",
				"012",
				"012",
				"013",
				"014",
				"014",
				"014",
				"014",
				"015",
				"016",
				"016",
				"016",
				"016",
				"017",
				"017",
				"017",
				"017",
				"017",
				"018",
				"018",
				"018",
				"018",
				"018",
				"019",
				"02",
				"030",
				"031",
				"032",
				"032",
				"032",
				"032",
				"033",
				"033",
				"034",
				"034",
				"034",
				"034",
				"034",
				"034",
				"035",
				"036",
				"036",
				"036",
				"036",
				"037",
				"037",
				"037",
				"037",
				"037",
				"037",
				"037",
				"038",
				"038",
				"038",
				"038",
				"038",
				"038",
				"039",
				"040",
				"041",
				"042",
				"042",
				"042",
				"042",
				"042",
				"042",
				"042",
				"042",
				"042",
				"043",
				"043",
				"043",
				"043",
				"043",
				"043",
				"043",
				"043",
				"043",
				"044",
				"044",
				"044",
				"045",
				"046",
				"046",
				"046",
				"046",
				"046",
				"047",
				"047",
				"047",
				"047",
				"048",
				"049",
				"050",
				"051",
				"052",
				"052",
				"052",
				"052",
				"052",
				"053",
				"053",
				"053",
				"053",
				"053",
				"054",
				"054",
				"054",
				"054",
				"054",
				"054",
				"054",
				"055",
				"056",
				"056",
				"056",
				"057",
				"057",
				"057",
				"057",
				"057",
				"057",
				"057",
				"058",
				"058",
				"058",
				"058",
				"058",
				"058",
				"059",
				"06070",
				"071",
				"072",
				"072",
				"073",
				"073",
				"073",
				"073",
				"073",
				"073",
				"073",
				"074",
				"074",
				"074",
				"074",
				"075",
				"076",
				"076",
				"076",
				"076",
				"077",
				"077",
				"077",
				"077",
				"077",
				"078",
				"078",
				"078",
				"078",
				"078",
				"078",
				"079",
				"080",
				"081",
				"082",
				"082",
				"082",
				"082",
				"082",
				"083",
				"083",
				"083",
				"083",
				"083",
				"085",
				"086",
				"086",
				"086",
				"086",
				"086",
				"087",
				"087",
				"087",
				"087",
				"087",
				"088",
				"088",
				"088",
				"088",
				"088",
				"089",
				"090",
				"091",
				"092",
				"092",
				"092",
				"092",
				"092",
				"093",
				"093",
				"093",
				"093",
				"093",
				"094",
				"094",
				"095",
				"096",
				"096",
				"096",
				"096",
				"096",
				"096",
				"096",
				"096",
				"097",
				"097",
				"097",
				"097",
				"097",
				"097",
				"098",
				"098",
				"098",
				"098",
				"098",
				"099",
			],
		},
	};

	//£ funzione per sanitize il numero di telefono e restituirlo senza l'eventuale prefisso
	function prefixCut(arr, country) {
		// console.log("country", country);
		// `${country}`
		// console.log("prefix array", objLocalizationPath[country].prefixCellular);
		const x = arr;
		objLocalizationPath[country].prefixCellular.map((items, index) => {
			// console.log('join', x.join(""));
			// console.log('items', items.length)
			//£ creiamo un array con i primi valori inseriti dall'utente in riferimento al controllo che andiamo a fare 
			//£ i primi 3 se il controllo lo andiamo a fare con un campo che ha 3 valori e 4 su 4 e così via

			let arrPrefix = [];
			for (let i = 0; i < items.length; i++) {
				// console.log('xx', x[i])
				arrPrefix.push(x[i])
			}
			// console.log('PREFIX', arrPrefix)
			if (JSON.stringify(arrPrefix.join("")) === JSON.stringify(items)) {
				x.splice(0, items.length);
				// console.log('fine', arrPhoneNumber);
			}
		});
		console.log('finercut', x);

		return x;
	}


	$(".form").submit(function (e) {
		// preveniamo il default
		e.preventDefault();
		// prendiamo tutti i valori delle input
		$(".form input").each(function (index, items) {
			// controlliamo che valore è richiesto nel labeel e attiviamo la validazione di riferimento 

			// ! VALIDAZIONE NUMERO DI TELEFONO

			if (items.getAttribute("data-validate-type") == "phone") {
				// console.log("items phone value", items.value.trim());
				// prediamo il valore dell'input lo dividiamo in un array con tutti i caratteri
				let arrPhoneNumber = items.value.split("");
				// passiamo pe la funzione di prefixCut che controlla se è stato messo il prefisso e lo taglia 
				arrPhoneNumber = prefixCut(
					arrPhoneNumber,
					items.getAttribute("data-validate-country"),
				).filter((value) => Number(value));

				console.log('fine', arrPhoneNumber);
			}
		});
	});
});
